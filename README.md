# Hourlys

Скрипт, преобразующий данные об электропотреблении предприятий в формате ХарьковОблЭнерго (ХОЭ), в сводную XLS-таблицу c данными о почасовом потреблении электроэнергии за месяц в процентном отношении.

## При написании использовались:

* Ruby 2.2.4;

* гем [axlsx](https://github.com/randym/axlsx) для создания XLS-таблиц.

## Использование

Файлы с данными электропотребления предприятий в формате ХОЭ с расширениями .txt помещаются в ту же папку, где находится файл скрипта. После запуска скрипт просматривает эти файлы и формирует сводную XLS-таблицу _output.xlsx_, где для каждого предприятия рассчитано среднемесячное почасовое потребление электроэнергии в процентном отношении.

Если имеются данные по нескольким счетчикам/договорам/точкам учета одного предприятия, то данные суммируются.

У скрипта имеется конфигурационный файл _hourlys.cfg_, где указывается соответствие между наименованиями предприятий в файлах ХОЭ и сокращенными наименованиями предприятий в сводной таблице в формате:

```
наименование предприятия в файле ХОЭ|сокращенное наименование в сводной таблице
```

Так, запись в конфигурационном файле:

```
ПрАТ "Філіп Морріс Україна"|Филип-Моррис
ПрАТ "ФІЛІП МОРРІС УКРАЇНА"|Филип-Моррис
```

означает, что оба наименования предприятия, встречающиеся в файлах данных ХОЭ, будут восприниматься скриптом как маркирующие данные о нескольких точках учета одного и того же предприятия, фигурирующего в сводной таблице под наименованием "Филип-Моррис".

В случае, если в файлах ХОЭ встретится наименование предприятия, не указанное в конфигурационном файле, скрипт выдаст предупреждающее сообщение. Данные о таком предприятии не будут внесены в сводную таблицу.
